generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-musl-openssl-3.0.x", "debian-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id               String    @id @default(uuid())
  email            String    @unique
  password         String
  role             String    @default("USER")
  fullName         String?
  farmName         String?
  farmAddress      String?
  piorinNumber     String?
  licenseStatus    String    @default("TRIAL")
  licenseExpiresAt DateTime?
  createdAt        DateTime  @default(now())

  // RELACJE - BEZ TEGO BUILD SIÄ˜ WYWALI
  fields           Field[]
  warehouseItems   WarehouseItem[]
  treatments       Treatment[]
}

model Field {
  id         String      @id @default(uuid())
  userId     String
  user       User        @relation(fields: [userId], references: [id])
  name       String
  area       Float
  cropType   String
  treatments Treatment[]
}

model WarehouseItem {
  id             String          @id @default(uuid())
  userId         String
  user           User            @relation(fields: [userId], references: [id])
  name           String
  batchNumber    String?
  expirationDate DateTime
  productionDate DateTime?
  quantity       Float
  unit           String
  isWaste        Boolean         @default(false)
  disposalDate   DateTime?
  treatmentItems TreatmentItem[]
}

model Treatment {
  id          String          @id @default(uuid())
  userId      String
  user        User            @relation(fields: [userId], references: [id])
  date        DateTime
  crop        String
  area        Float
  temperature Float?
  windSpeed   Float?
  fieldId     String?
  field       Field?          @relation(fields: [fieldId], references: [id])
  items       TreatmentItem[]
}

model TreatmentItem {
  id              String        @id @default(uuid())
  treatmentId     String
  treatment       Treatment     @relation(fields: [treatmentId], references: [id])
  warehouseItemId String
  warehouseItem   WarehouseItem @relation(fields: [warehouseItemId], references: [id])
  dosage          Float
  amountUsed      Float
}